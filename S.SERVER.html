<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="S.CLIENT.html">
<link rel="Up" href="S.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="S" rel="Chapter" href="S.html">
<link title="Protocol" rel="Chapter" href="Protocol.html">
<link title="Nbd_result" rel="Chapter" href="Nbd_result.html">
<link title="Client" rel="Chapter" href="Client.html">
<link title="Channel" rel="Chapter" href="Channel.html">
<link title="Server" rel="Chapter" href="Server.html">
<link title="Mux" rel="Chapter" href="Mux.html">
<link title="Mirror" rel="Chapter" href="Mirror.html">
<link title="Nbd_lwt_unix" rel="Chapter" href="Nbd_lwt_unix.html"><title>S.SERVER</title>
</head>
<body>
<div class="navbar"><a class="pre" href="S.CLIENT.html" title="S.CLIENT">Previous</a>
&nbsp;<a class="up" href="S.html" title="S">Up</a>
&nbsp;</div>
<h1>Module type <a href="type_S.SERVER.html">S.SERVER</a></h1>

<pre><span class="keyword">module type</span> SERVER = <code class="code">sig</code> <a href="S.SERVER.html">..</a> <code class="code">end</code></pre><hr width="100%">
<br>
A Server allows you to expose an existing block device to remote clients
      over NBD.<br>

<pre><span id="TYPEt"><span class="keyword">type</span> <code class="type"></code>t</span> </pre>
<div class="info ">
An open connection to an NBD client<br>
</div>


<pre><span id="TYPEsize"><span class="keyword">type</span> <code class="type"></code>size</span> = <code class="type">int64</code> </pre>
<div class="info ">
The size of a remote disk<br>
</div>


<pre><span id="TYPEname"><span class="keyword">type</span> <code class="type"></code>name</span> = <code class="type">string</code> </pre>
<div class="info ">
The name of an export. In the 'new style' protocol as used in nbd &gt;= 2.9.17
      the client must select an export by name.<br>
</div>


<pre><span id="VALconnect"><span class="keyword">val</span> connect</span> : <code class="type"><a href="Channel.html#TYPEchannel">Channel.channel</a> -><br>       ?offer:<a href="S.SERVER.html#TYPEname">name</a> list -> unit -> (<a href="S.SERVER.html#TYPEname">name</a> * <a href="S.SERVER.html#TYPEt">t</a>) Lwt.t</code></pre><div class="info ">
<code class="code">connect channel ?offer ()</code> performs the 'new style' initial handshake
      and options negotiation. If <code class="code">?offer</code> is provided then these names will be returned
      if the client requests a list of exports, otherwise we will return EPERM.
      The client's choice of name is returned which must be looked up by the
      application. If the name is invalid, the only option is to close the connection.
      If the name is valid then use the <code class="code">serve</code> function.<br>
</div>

<pre><span id="VALserve"><span class="keyword">val</span> serve</span> : <code class="type"><a href="S.SERVER.html#TYPEt">t</a> -> (module V1_LWT.BLOCK with type t = 'b) -> 'b -> unit Lwt.t</code></pre><div class="info ">
<code class="code">serve t block b</code> runs forever processing requests from <code class="code">t</code>, using <code class="code">block</code>
      device type <code class="code">b</code>.<br>
</div>

<pre><span id="VALclose"><span class="keyword">val</span> close</span> : <code class="type"><a href="S.SERVER.html#TYPEt">t</a> -> unit Lwt.t</code></pre><div class="info ">
<code class="code">close t</code> shuts down the connection <code class="code">t</code> and frees any allocated resources<br>
</div>
</body></html>